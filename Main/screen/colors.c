#include "screen/canvas.h"

#define UINT16_DUP(p)  ((uint16_t)(p) << 8 | (uint16_t)(p))

// Y-Cb-Cr 6-bit 64 color palette (indexed by BBGGRR)
// Only Cb-Cr part
const NV12_UV_t uv_table[] = {
	/*000000*/ 	{ .Cb = 128, .Cr = 129 },
	/*000001*/ 	{ .Cb = 115, .Cr = 166 },
	/*000010*/ 	{ .Cb = 103, .Cr = 204 },
	/*000011*/ 	{ .Cb = 90, .Cr = 240 },
	/*000100*/ 	{ .Cb = 103, .Cr = 98 },
	/*000101*/ 	{ .Cb = 92, .Cr = 135 },
	/*000110*/ 	{ .Cb = 78, .Cr = 172 },
	/*000111*/ 	{ .Cb = 66, .Cr = 209 },
	/*001000*/ 	{ .Cb = 79, .Cr = 66 },
	/*001001*/ 	{ .Cb = 66, .Cr = 104 },
	/*001010*/ 	{ .Cb = 53, .Cr = 141 },
	/*001011*/ 	{ .Cb = 41, .Cr = 178 },
	/*001100*/ 	{ .Cb = 54, .Cr = 35 },
	/*001101*/ 	{ .Cb = 41, .Cr = 72 },
	/*001110*/ 	{ .Cb = 29, .Cr = 110 },
	/*001111*/ 	{ .Cb = 16, .Cr = 146 },
	/*010000*/ 	{ .Cb = 165, .Cr = 123 },
	/*010001*/ 	{ .Cb = 153, .Cr = 160 },
	/*010010*/ 	{ .Cb = 140, .Cr = 198 },
	/*010011*/ 	{ .Cb = 128, .Cr = 234 },
	/*010100*/ 	{ .Cb = 141, .Cr = 92 },
	/*010101*/ 	{ .Cb = 128, .Cr = 127 },
	/*010110*/ 	{ .Cb = 114, .Cr = 165 },
	/*010111*/ 	{ .Cb = 102, .Cr = 203 },
	/*011000*/ 	{ .Cb = 116, .Cr = 60 },
	/*011001*/ 	{ .Cb = 103, .Cr = 96 },
	/*011010*/ 	{ .Cb = 92, .Cr = 134 },
	/*011011*/ 	{ .Cb = 78, .Cr = 171 },
	/*011100*/ 	{ .Cb = 91, .Cr = 28 },
	/*011101*/ 	{ .Cb = 80, .Cr = 65 },
	/*011110*/ 	{ .Cb = 66, .Cr = 103 },
	/*011111*/ 	{ .Cb = 53, .Cr = 140 },
	/*100000*/ 	{ .Cb = 203, .Cr = 117 },
	/*100001*/ 	{ .Cb = 190, .Cr = 154 },
	/*100010*/ 	{ .Cb = 177, .Cr = 192 },
	/*100011*/ 	{ .Cb = 165, .Cr = 228 },
	/*100100*/ 	{ .Cb = 178, .Cr = 86 },
	/*100101*/ 	{ .Cb = 166, .Cr = 122 },
	/*100110*/ 	{ .Cb = 152, .Cr = 160 },
	/*100111*/ 	{ .Cb = 140, .Cr = 197 },
	/*101000*/ 	{ .Cb = 153, .Cr = 54 },
	/*101001*/ 	{ .Cb = 140, .Cr = 92 },
	/*101010*/ 	{ .Cb = 128, .Cr = 126 },
	/*101011*/ 	{ .Cb = 114, .Cr = 166 },
	/*101100*/ 	{ .Cb = 128, .Cr = 22 },
	/*101101*/ 	{ .Cb = 116, .Cr = 59 },
	/*101110*/ 	{ .Cb = 104, .Cr = 98 },
	/*101111*/ 	{ .Cb = 91, .Cr = 134 },
	/*110000*/ 	{ .Cb = 240, .Cr = 110 },
	/*110001*/ 	{ .Cb = 227, .Cr = 147 },
	/*110010*/ 	{ .Cb = 215, .Cr = 185 },
	/*110011*/ 	{ .Cb = 202, .Cr = 222 },
	/*110100*/ 	{ .Cb = 215, .Cr = 79 },
	/*110101*/ 	{ .Cb = 203, .Cr = 116 },
	/*110110*/ 	{ .Cb = 190, .Cr = 153 },
	/*110111*/ 	{ .Cb = 177, .Cr = 191 },
	/*111000*/ 	{ .Cb = 190, .Cr = 47 },
	/*111001*/ 	{ .Cb = 178, .Cr = 85 },
	/*111010*/ 	{ .Cb = 165, .Cr = 122 },
	/*111011*/ 	{ .Cb = 153, .Cr = 159 },
	/*111100*/ 	{ .Cb = 166, .Cr = 16 },
	/*111101*/ 	{ .Cb = 153, .Cr = 53 },
	/*111110*/ 	{ .Cb = 141, .Cr = 91 },
	/*111111*/ 	{ .Cb = 128, .Cr = 128 }
};

// Only Y part (repeated twice) indexed by XOR(Cb ^ Cr)
const uint16_t y_table[] = {
	[0] = UINT16_DUP(255),
	[1] = UINT16_DUP(16),
	[5] = UINT16_DUP(59),
	[6] = UINT16_DUP(192),
	[7] = UINT16_DUP(132),
	[10] = UINT16_DUP(205),
	[13] = UINT16_DUP(102),
	[14] = UINT16_DUP(149),
	[17] = UINT16_DUP(175),
	[20] = UINT16_DUP(107),
	[21] = UINT16_DUP(145),
	[36] = UINT16_DUP(55),
	[37] = UINT16_DUP(197),
	[39] = UINT16_DUP(128),
	[42] = UINT16_DUP(124),
	[56] = UINT16_DUP(119),
	[57] = UINT16_DUP(46),
	[65] = UINT16_DUP(98),
	[71] = UINT16_DUP(153),
	[72] = UINT16_DUP(110),
	[73] = UINT16_DUP(141),
	[74] = UINT16_DUP(68),
	[79] = UINT16_DUP(183),
	[97] = UINT16_DUP(166),
	[106] = UINT16_DUP(90),
	[110] = UINT16_DUP(85),
	[112] = UINT16_DUP(63),
	[113] = UINT16_DUP(76),
	[115] = UINT16_DUP(188),
	[130] = UINT16_DUP(210),
	[145] = UINT16_DUP(127),
	[147] = UINT16_DUP(124),
	[150] = UINT16_DUP(161),
	[152] = UINT16_DUP(84),
	[155] = UINT16_DUP(167),
	[158] = UINT16_DUP(41),
	[170] = UINT16_DUP(82),
	[171] = UINT16_DUP(60),
	[172] = UINT16_DUP(191),
	[173] = UINT16_DUP(133),
	[175] = UINT16_DUP(118),
	[182] = UINT16_DUP(170),
	[184] = UINT16_DUP(145),
	[185] = UINT16_DUP(218),
	[190] = UINT16_DUP(33),
	[191] = UINT16_DUP(106),
	[208] = UINT16_DUP(140),
	[209] = UINT16_DUP(67),
	[212] = UINT16_DUP(184),
	[213] = UINT16_DUP(38),
	[214] = UINT16_DUP(213),
	[215] = UINT16_DUP(111),
	[218] = UINT16_DUP(154),
	[219] = UINT16_DUP(81),
	[220] = UINT16_DUP(97),
	[221] = UINT16_DUP(227),
	[222] = UINT16_DUP(24),
	[223] = UINT16_DUP(170),
	[226] = UINT16_DUP(103),
	[228] = UINT16_DUP(76),
	[229] = UINT16_DUP(176),
	[231] = UINT16_DUP(149),
	[254] = UINT16_DUP(175),
	[255] = UINT16_DUP(89)
};

// Convert CrCb back to 6 bit RGB
const uint8_t rgb_table[] = {
	[0] = 0b00111111,
	[1] = 0b00000000,
	[5] = 0b00000100,
	[6] = 0b00111011,
	[7] = 0b00011001,
	[10] = 0b00101110,
	[13] = 0b00001000,
	[14] = 0b00110111,
	[17] = 0b00011101,
	[20] = 0b00110011,
	[21] = 0b00001100,
	[36] = 0b00100001,
	[37] = 0b00011110,
	[39] = 0b00110110,
	[42] = 0b00001001,
	[56] = 0b00100110,
	[57] = 0b00010001,
	[65] = 0b00100011,
	[71] = 0b00011100,
	[72] = 0b00011000,
	[73] = 0b00100111,
	[74] = 0b00010010,
	[79] = 0b00101101,
	[97] = 0b00001101,
	[106] = 0b00010011,
	[110] = 0b00110010,
	[112] = 0b00110001,
	[113] = 0b00100010,
	[115] = 0b00001110,
	[130] = 0b00001111,
	[145] = 0b00111000,
	[147] = 0b00000111,
	[150] = 0b00101100,
	[152] = 0b00110100,
	[155] = 0b00001011,
	[158] = 0b00110000,
	[170] = 0b00000011,
	[171] = 0b00000010,
	[172] = 0b00111101,
	[173] = 0b00010111,
	[175] = 0b00101000,
	[182] = 0b00111100,
	[184] = 0b00001010,
	[185] = 0b00011111,
	[190] = 0b00100000,
	[191] = 0b00110101,
	[208] = 0b00101001,
	[209] = 0b00010100,
	[212] = 0b00101011,
	[213] = 0b00000001,
	[214] = 0b00111110,
	[215] = 0b00010110,
	[218] = 0b00011010,
	[219] = 0b00000101,
	[220] = 0b00100101,
	[221] = 0b00101111,
	[222] = 0b00010000,
	[223] = 0b00111010,
	[226] = 0b00000110,
	[228] = 0b00100100,
	[229] = 0b00011011,
	[231] = 0b00111001,
	[254] = 0b00101010,
	[255] = 0b00010101
};

// convert RGB222 to perceived grayscale luminocity (Y)
const uint8_t grayscale_table[] = {
	/*000000*/ 0,
	/*000001*/ 6,
	/*000010*/ 12,
	/*000011*/ 18,
	/*000100*/ 61,
	/*000101*/ 67,
	/*000110*/ 73,
	/*000111*/ 79,
	/*001000*/ 122,
	/*001001*/ 128,
	/*001010*/ 134,
	/*001011*/ 140,
	/*001100*/ 183,
	/*001101*/ 189,
	/*001110*/ 195,
	/*001111*/ 201,
	/*010000*/ 18,
	/*010001*/ 24,
	/*010010*/ 30,
	/*010011*/ 36,
	/*010100*/ 79,
	/*010101*/ 85,
	/*010110*/ 91,
	/*010111*/ 97,
	/*011000*/ 140,
	/*011001*/ 146,
	/*011010*/ 152,
	/*011011*/ 158,
	/*011100*/ 201,
	/*011101*/ 207,
	/*011110*/ 213,
	/*011111*/ 219,
	/*100000*/ 36,
	/*100001*/ 42,
	/*100010*/ 48,
	/*100011*/ 54,
	/*100100*/ 97,
	/*100101*/ 103,
	/*100110*/ 109,
	/*100111*/ 115,
	/*101000*/ 158,
	/*101001*/ 164,
	/*101010*/ 170,
	/*101011*/ 176,
	/*101100*/ 219,
	/*101101*/ 225,
	/*101110*/ 231,
	/*101111*/ 237,
	/*110000*/ 54,
	/*110001*/ 60,
	/*110010*/ 66,
	/*110011*/ 72,
	/*110100*/ 115,
	/*110101*/ 121,
	/*110110*/ 127,
	/*110111*/ 133,
	/*111000*/ 176,
	/*111001*/ 182,
	/*111010*/ 188,
	/*111011*/ 194,
	/*111100*/ 237,
	/*111101*/ 243,
	/*111110*/ 249,
	/*111111*/ 255
};
